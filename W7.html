<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>FreePay TON Payment</title>
  <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
</head>
<body style="font-family: sans-serif; text-align:center; margin-top:50px;">

  <h2>ğŸ’ Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ TON</h2>
  <button id="connect-btn">Ø§ØªØµØ§Ù„ Tonkeeper</button>
  <p id="wallet-address"></p>

  <div id="transfer-box" style="display:none;">
    <h3>Ø§Ø±Ø³Ø§Ù„ TON</h3>
    <input id="amount" type="number" placeholder="Ù…Ù‚Ø¯Ø§Ø± TON" step="0.1" style="padding:5px;">
    <button id="send-btn">Ø§Ø±Ø³Ø§Ù„</button>
  </div>

  <script>
    const tonConnect = new TON_CONNECT.TonConnect({
      manifestUrl: "https://solider1385.github.io/Best-Coin.io/tonconnect-manifest.json"
    });

    const connectBtn = document.getElementById("connect-btn");
    const walletAddress = document.getElementById("wallet-address");
    const transferBox = document.getElementById("transfer-box");
    const sendBtn = document.getElementById("send-btn");

    async function connectWallet() {
      try {
        alert("Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Tonkeeper...");
        const connectedWallet = await tonConnect.connectWallet();
        alert("Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚!");

        walletAddress.innerText = "Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„ Ø´Ø¯: " + connectedWallet.account.address;
        transferBox.style.display = "block";
      } catch (error) {
        alert("Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: " + error.message);
      }
    }

    async function sendTON() {
      try {
        const amount = document.getElementById("amount").value;
        if (!amount) return alert("Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!");

        const tx = {
          validUntil: Math.floor(Date.now() / 1000) + 600, // Ù…Ø¹ØªØ¨Ø± ØªØ§ 10 Ø¯Ù‚ÛŒÙ‚Ù‡
          messages: [
            {
              address: "UQABfJXpm1D0Qm6pPutSjbEHVAWFzqvKv4BRSoFdA-5_En8Q", // Ø¢Ø¯Ø±Ø³ Ø¯Ø±ÛŒØ§ÙØªâ€ŒÚ©Ù†Ù†Ø¯Ù‡
              amount: (parseFloat(amount) * 1e9).toString() // ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ nanotons
            }
          ]
        };

        alert("Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Tonkeeper...");
        await tonConnect.sendTransaction(tx);
        alert("Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯! Ù„Ø·ÙØ§Ù‹ Ø¯Ø± Tonkeeper ØªØ£ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯.");
      } catch (error) {
        alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ ØªØ±Ø§Ú©Ù†Ø´: " + error.message);
      }
    }

    connectBtn.onclick = connectWallet;
    sendBtn.onclick = sendTON;
  </script>

</body>
</html>
