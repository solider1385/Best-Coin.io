<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TON Wallet Tools</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<h3>✅ بررسی موجودی + انتقال TON</h3>

<label>آدرس کیف پول TonKeeper:</label><br>
<input id="address" placeholder="EQ...." style="width:300px"><br><br>

<button onclick="checkBalance()">دریافت موجودی</button>
<p id="balance"></p>

<hr>

<label>میزان TON برای انتقال:</label><br>
<input id="amount" placeholder="مثال: 0.5"><br><br>

<label>آدرس مقصد:</label><br>
<input id="to" placeholder="EQ...." style="width:300px"><br><br>

<button onclick="send()">ارسال TON</button>


<script>
// دریافت موجودی
async function checkBalance() {
    let addr = document.getElementById("address").value;
    if (!addr) return alert("آدرس وارد نشده!");

    try {
        let url = `https://toncenter.com/api/v2/getAddressBalance?address=${addr}`;
        let data = await fetch(url).then(r=>r.json());
        
        if (data.ok) {
            let nano = Number(data.result);
            let ton = nano / 1e9;
            document.getElementById("balance").innerText = "موجودی: " + ton + " TON";
        } else {
            alert("خطا در دریافت موجودی");
        }

    } catch(e){
        alert("Error");
    }
}


// ارسال TON
function send() {
    let to = document.getElementById("to").value;
    let amount = document.getElementById("amount").value;
    
    if (!to || !amount) return alert("آدرس یا مبلغ وارد نشده!");

    let nano = Math.floor(amount * 1e9);

    let link = `ton://transfer/${to}?amount=${nano}`;

    if (window.Telegram && Telegram.WebApp) {
        Telegram.WebApp.openLink(link);
    } else {
        window.location.href = link;
    }
}
</script>

</body>
</html>
